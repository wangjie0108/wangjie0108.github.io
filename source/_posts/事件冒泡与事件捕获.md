---
title: 事件冒泡与事件捕获
date: 2018-4-02 08:56:25
categories: 
    - '前端'
    - js
tags: 
    - js
---

###### 事件冒泡与事件捕获

+ 事件冒泡

```javascript
    <!-- css样式 -->
	<style>
        #box1 {
            width: 400px;
            height: 400px;
            background-color: pink;
        }

        #box2 {
            width: 300px;
            height: 300px;
            background-color: skyblue;
        }

        #box3 {
            width: 200px;
            height: 200px;
            background-color: lightgray;
        }
    </style>

<body>
    <div id="box1">
        <div id="box2">
            <div id="box3"></div>
        </div>
    </div>
</body>

<!-- javascript -->
<script>
    var box1 = document.getElementById('box1');
    var box2 = document.getElementById('box2');
    var box3 = document.getElementById('box3');
    var arr = [box1, box2, box3];
    for (var i = 0; i < arr.length; i++) {
        arr[i].addEventListener('click', function () {
            console.log(this.id);
        }, false);
    }
    document.body.addEventListener('click', function () {
        console.log('body');
    }, false);
    document.addEventListener('click', function () {
        console.log('document');
    }, false);
</script>
```

```javascript
// addEventListener 的第三个参数为false的时候 ： 事件冒泡
// 事件开始发生（从里向外）依次输出： box3 - box2 - box1 - body - document
```

+ 事件捕获

```javascript
// addEventListener 的第三个参数为true 的时候 ： 事件捕获
// 事件开始（从外向内进行捕获） 依次输出： document - body - box1 - box2 -box3 
```

```javascript
// 注册事件三种方式：
1.`onclick`:浏览器无法判断捕获阶段，因此只有冒泡阶段
for (var i = 0; i < arr.length; i++){
  arr[i].onclick = function () {
    console.log(this.id);
  }
}
2.`attachEvent`：两个参数，浏览器无法判断捕获阶段，只有冒泡阶段
for (var i = 0; i < arr.length; i++){
	arr[i].attachEvent('click', function (){
      console.log(this.id);
	});
}
3.`addEventListener`:有三个参数 当第三个参数为false时，事件冒泡；
   :第三个参数是true时，事件捕获；
```
##### 事件三个阶段
1. 捕获阶段 ： 由外向内
2. 当前目标阶段
3. 冒泡阶段 ： 由内向外
+ 浏览器执行原理：先执行捕获状态，从最外层向最里层去执行，捕获在冒泡之前
    - e 事件参数：当事件发生的时候，可以获取一些和事件相关的数据；
    - e.target 是真正触发事件的对象
    但在老版本IE中，获取事件对象的方式是： window.event
##### e.target 和 this的区别
    - e.target 是指从哪里冒出来的那个元素（当前元素最深处）
    - this：事件执行者
##### e.target 和 e.currentTarget
    - e.target：获取真正触发事件的对象
    - e.currentTarget：事件处理函数所处的对象
+ e.eventPhase 属性可以查看事件触发时所处的阶段
##### 阻止事件冒泡的方式：
    - 标准方式: event.stopPropagation()
    - IE低版本：event.cancleBubble() = true;标准中已经废弃
##### 事件三要素：
    - 事件源：触发事件的元素
    - 事件名称：
    - 事件处理函数：事件触发后要执行的代码（函数形式）
##### 阻止默认行为
    - event.preventDefault()；
    - return false()
+ 注意： 在jQuery中，return false()可以阻止事件冒泡