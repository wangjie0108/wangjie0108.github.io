---
title: 深拷贝与浅拷贝
date: 2018-3-03 11:17:26
categories: 
    - '前端'
    - js
tags: 
    - js
---
##### 浅拷贝
---
```javascript
<script>
    var obj1 = {
        name: '金毛',
        age: 20,
        sex: '男',
        dog: {
            name: '大黄',
            age: 2,
            sex: 'male'
        }
    }

    var obj2 = {};

    for (var key in obj1) {
        obj2[key] = obj1[key];
    }

    obj1.name = '我变变'
    obj1.dog.name = '狗狗变'
    console.log(obj1);
    console.log(obj2)
</script>
```
1. 浅拷贝只拷贝对象的第一层属性, 第一层属性中有某个属性是复杂数据类型，会拷贝复杂数据类型的引用地址
2. dog是对象 是复杂类型，因此，值会被修改
3. 输出结果如图：
![深拷贝](/img/浅拷贝.png)

##### 深拷贝
---
```javascript
<script>
    var obj1 = {
        name: '金毛',
        age: 20,
        sex: '男',
        dog: {
            name: '大黄',
            age: 2,
            sex: 'male'
        },
        friends: ['1', '2', '3']
    }
    var obj2 = {};

    function deepCopy(o1, o2) {
        for(var key in o1) {
            if(o1[key] instanceof Array) {
                o2[key] = [];
                deepCopy(o1[key], o2[key]);
            } else if (o1[key] instanceof Object) {
                o2[key] = [];
                deepCopy(o1[key], o2[key]);
            } else {
                o2[key] = o1[key];
            }
        }   
    }

    deepCopy(obj1, obj2);

    obj1.name = '我变变'
    obj1.dog.name = '狗狗变'
    obj1.friends = ['敬', '自', '己']
    console.log(obj1);
    console.log(obj2)
</script>
```
+ 输出结果如图：
![深拷贝](/img/深拷贝.png)
1. 注意：Object可以理解为是所有对象的祖宗，因此，在判断的时候，需要先判断是不是数组，再判断是不是对象，顺序不能反;
2. 深拷贝，是拷贝对象各个层级的属性
3. 总结：
    1. 复杂数据之间的相互赋值，就是用等号(=)进行相互赋值的时候，是引用地址的赋值；
    2. 拷贝指的是把它的属性和方法全部取出来复制一遍，然后放到一个全新的看起来一模一样的对象中；
    3. 深拷贝和浅拷贝是对象拷贝的两种手段
    4. 浅拷贝的话，复制出来的新的对象只能拷贝原对象的第一层属性，如果第一层属性里面有某个属性是复杂数据类型，浅拷贝只是将复杂数据类型的引用地址拷贝过去；
    5. 深拷贝会利用递归的原理一层一层的将对象各个层级的属性都拷贝出来
